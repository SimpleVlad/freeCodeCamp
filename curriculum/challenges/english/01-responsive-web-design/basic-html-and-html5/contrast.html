<html>
<head>
<meta charset="utf-8">
<title>OpenCV.js</title>
</head>
<body>
<h2>OpenCV.js</h2>
<p id="status">OpenCV.js is loading...</p>
<div>
  <div class="inputoutput">
    <img id="imageSrc" src="pic1.jpg"/>
      <div class="caption">
        Run example:<input type="button" id="myButton" onclick="update()"
        value="Run" disabled=true/>
      </div>
    <div class="slide">
    Contrast:<input type="range" min="1.0" max="3.0" step="0.1" value="1.5"
    id="Contrast" onchange="update()">
    Brightness:<input type="range" min="0" max="100" step="1" value="50"
    id="Brightness" onchange="update()">
  </div>
  </div>
  <div class="inputoutput">
    <canvas id="canvasOutput" >
    </canvas>
    <div class="caption">Result</div>
  </div>
</div>

<script type="text/javascript">

//Source:
//https://docs.opencv.org/master/d2/de8/group__core__array.html#ga3460e9c9f37b563ab9dd550c4d8c4e7d

function update() {
  let mat = cv.imread(document.getElementById('imageSrc'));
  let dst = new cv.Mat();
  let cont = Number(document.getElementById("Contrast").value);
  let brig = Number(document.getElementById("Brightness").value);

  cv.convertScaleAbs(mat, dst, cont, brig);

  cv.imshow('canvasOutput', dst);
  mat.delete();
  dst.delete();
};

function onOpenCvReady() {
  document.getElementById("status").innerHTML = "OpenCV.js is ready.";
  cv["onRuntimeInitialized"] = () => {
   document.getElementById("myButton").disabled = false;
  }
}

</script>

<script async src="opencv.js" onload="onOpenCvReady();" type="text/javascript">
</script>
</body>
</html>
